WITH APPLES AS
( SELECT SALE_DATE, SOLD_NUM FROM SALES WHERE FRUIT='APPLES') ,

ORANGES AS(SELECT SALE_DATE, SOLD_NUM FROM SALES WHERE FRUIT='ORANGES') 

SELECT A.SALE_DATE, (A.SOLD_NUM-O.SOLD_NUM ) AS 'DIFF' FROM APPLES A JOIN ORANGES O ON A.SALE_DATE=O.SALE_DATE ORDER BY A.SALE_DATE;
